function WexflowManager(t,e){"use strict";function n(t,e){t.disabled=e}function s(t,e){for(;t.charAt(t.length-1)===e;)t=t.substring(0,t.length-1);return t}function a(t,e){return t.Id<e.Id?-1:t.Id>e.Id?1:0}function i(t){switch(t){case 0:return"Startup";case 1:return"Trigger";case 2:return"Periodic";case 3:return"Cron";default:return""}}function o(t,e,n){var s=new XMLHttpRequest;s.onreadystatechange=function(){if(4===this.readyState&&200===this.status&&e){var t=JSON.parse(this.responseText);e(t)}},s.onerror=function(){n&&n()},s.open("GET",t,!0),s.send()}function r(t,e){var n=new XMLHttpRequest;n.onreadystatechange=function(){4===this.readyState&&200===this.status&&e&&e()},n.open("POST",t,!0),n.send()}e=s(e,"/");var d=-1,u={},c=null,l=500,f="<div id='wf-container'><div id='wf-cmd'><button id='wf-start' type='button' class='btn btn-primary btn-sm'>Start</button><button id='wf-pause' type='button' class='btn btn-secondary btn-sm'>Suspend</button><button id='wf-resume' type='button' class='btn btn-secondary btn-sm'>Resume</button><button id='wf-stop' type='button' class='btn btn-outline-danger btn-sm'>Stop</button></div><div id='wf-notifier'><input id='wf-notifier-text' type='text' name='fname' readonly></div><div id='wf-workflows'></div></div>";document.getElementById(t).innerHTML=f;var w=document.getElementById("wf-start"),m=document.getElementById("wf-pause"),h=document.getElementById("wf-resume"),b=document.getElementById("wf-stop");n(w,!0),n(m,!0),n(h,!0),n(b,!0),o(e+"/workflows",function(t){function s(t,n){o(e+"/workflow/"+t,function(t){n(t)})}function f(t){document.getElementById("wf-notifier-text").value=t}function I(t,e){s(t,function(t){if(t.IsEnabled===!1)f("This workflow is disabled."),n(w,!0),n(m,!0),n(h,!0),n(b,!0);else{if(e===!1&&g(t)===!1)return;n(w,t.IsRunning),n(b,!(t.IsRunning&&!t.IsPaused)),n(m,!(t.IsRunning&&!t.IsPaused)),n(h,!t.IsPaused),f(t.IsRunning===!0&&t.IsPaused===!1?"This workflow is running...":t.IsPaused===!0?"This workflow is suspended.":"")}})}function g(t){var e=u[t.Id].IsRunning!==t.IsRunning||u[t.Id].IsPaused!==t.IsPaused;return u[t.Id].IsRunning=t.IsRunning,u[t.Id].IsPaused=t.IsPaused,e}t.sort(a);var y,p=[];for(y=0;y<t.length;y++){var v=t[y];u[v.Id]=v;var k=i(v.LaunchType);p.push("<tr><td class='wf-id' title='"+v.Id+"'>"+v.Id+"</td><td class='wf-n' title='"+v.Name+"'>"+v.Name+"</td><td class='wf-lt'>"+k+"</td><td class='wf-e'><input type='checkbox' readonly disabled "+(v.IsEnabled?"checked":"")+"></input></td><td class='wf-d' title='"+v.Description+"'>"+v.Description+"</td></tr>")}var E="<table id='wf-workflows-table' class='table table-hover'><thead class='thead-inverse'><tr><th class='wf-id'>Id</th><th class='wf-n'>Name</th><th class='wf-lt'>LaunchType</th><th class='wf-e'>Enabled</th><th class='wf-d'>Description</th></tr></thead><tbody>"+p.join("")+"</tbody></table>";document.getElementById("wf-workflows").innerHTML=E;var T=document.getElementById("wf-workflows-table"),B=document.getElementsByClassName("wf-d");for(y=0;y<B.length;y++)B[y].style.width=T.offsetWidth-517+"px";var N=T.getElementsByTagName("tbody")[0].getElementsByTagName("tr");for(y=0;y<N.length;y++)N[y].onclick=function(){d=parseInt(this.getElementsByClassName("wf-id")[0].innerHTML);var t=document.getElementsByClassName("selected");t.length>0&&(t[0].className=t[0].className.replace("selected","")),this.className+="selected",clearInterval(c),u[d].IsEnabled===!0?(c=setInterval(function(){I(d,!1)},l),I(d,!0)):I(d,!0)};w.onclick=function(){var t=e+"/start/"+d;r(t)},m.onclick=function(){var t=e+"/suspend/"+d;r(t,function(){I(d,!0)})},h.onclick=function(){var t=e+"/resume/"+d;r(t)},b.onclick=function(){var t=confirm("Are you sure you want to stop this workflow?");if(t===!0){var n=e+"/stop/"+d;r(n,function(){I(d,!0)})}}},function(){alert("An error occured while retrieving workflows. Check Wexflow Web Service Uri and check that Wexflow Windows Service is running correctly.")})}