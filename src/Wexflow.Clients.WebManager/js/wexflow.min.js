function wexflow(t,e){function n(t,e){for(;t.charAt(t.length-1)==e;)t=t.substring(0,t.length-1);return t}function s(t,e){return t.Id<e.Id?-1:t.Id>e.Id?1:0}function a(t){switch(t){case 0:return"Startup";case 1:return"Trigger";case 2:return"Periodic"}}function d(t,e){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var t=JSON.parse(this.responseText);e(t)}},n.open("GET",t,!0),n.send()}function o(t,e){var n=new XMLHttpRequest;n.onreadystatechange=function(){console.log("onreadystatechange: "+this.readyState+", "+this.status),4==this.readyState&&200==this.status&&e()},n.open("POST",t,!0),n.send()}e=n(e,"/");var u=-1,r={},c=null,l=500,f="<div id='wf-container'><div id='wf-cmd'><button id='wf-start' type='button'>Start</button><button id='wf-pause' type='button'>Suspend</button><button id='wf-resume' type='button'>Resume</button><button id='wf-stop' type='button'>Stop</button></div><div id='wf-notifier'><input id='wf-notifier-text' type='text' name='fname' readonly></div><div id='wf-workflows'></div></div>";document.getElementById(t).innerHTML=f,d(e+"/workflows",function(t){function n(t,n){d(e+"/workflow/"+t,function(t){n(t)})}function f(t){document.getElementById("wf-notifier-text").value=t}function w(t,e){n(t,function(t){if(t.IsEnabled===!1)f("This workflow is disabled."),m(E,!0),m(k,!0),m(T,!0),m(B,!0);else{if(e===!1&&I(t)===!1)return;m(E,t.IsRunning),m(B,!(t.IsRunning&&!t.IsPaused)),m(k,!(t.IsRunning&&!t.IsPaused)),m(T,!t.IsPaused),f(t.IsRunning===!0&&t.IsPaused===!1?"This workflow is running...":t.IsPaused===!0?"This workflow is paused.":"")}})}function I(t){var e=!1;return r[t.Id].IsRunning!==t.IsRunning&&(e=!0),r[t.Id].IsPaused!==t.IsPaused&&(e=!0),r[t.Id].IsRunning=t.IsRunning,r[t.Id].IsPaused=t.IsPaused,e}function m(t,e){t.disabled=e}t.sort(s);var h=[];for(i=0;i<t.length;i++){var g=t[i];r[g.Id]=g;var p=a(g.LaunchType);h.push("<tr><td class='wf-id' title='"+g.Id+"'>"+g.Id+"</td><td class='wf-n' title='"+g.Name+"'>"+g.Name+"</td><td class='wf-lt'>"+p+"</td><td class='wf-e'>"+g.IsEnabled+"</td><td class='wf-d' title='"+g.Description+"'>"+g.Description+"</td></tr>")}var y="<table id='wf-workflows-table' class='table table-striped'><thead><tr><th class='wf-id'>Id</th><th class='wf-n'>Name</th><th class='wf-lt'>LaunchType</th><th class='wf-e'>Enabled</th><th class='wf-d'>Description</th></tr></thead><tbody>"+h.join("")+"</tbody></table>";document.getElementById("wf-workflows").innerHTML=y;var b=document.getElementById("wf-workflows-table"),v=document.getElementsByClassName("wf-d");for(i=0;i<v.length;i++)v[i].style.width=b.offsetWidth-517+"px";var E=document.getElementById("wf-start"),k=document.getElementById("wf-pause"),T=document.getElementById("wf-resume"),B=document.getElementById("wf-stop"),N=b.getElementsByTagName("tbody")[0].getElementsByTagName("tr");for(i=0;i<N.length;i++)N[i].onclick=function(){u=parseInt(this.getElementsByClassName("wf-id")[0].innerHTML);var t=document.getElementsByClassName("selected");t.length>0&&(t[0].className=t[0].className.replace("selected","")),this.className+="selected",clearInterval(c),c=setInterval(function(){w(u,!1)},l),w(u,!0)};m(E,!0),E.onclick=function(){var t=e+"/start/"+u;o(t,function(t){})},m(k,!0),k.onclick=function(){var t=e+"/suspend/"+u;o(t,function(t){w(u,!0)})},m(T,!0),T.onclick=function(){var t=e+"/resume/"+u;o(t,function(t){})},m(B,!0),B.onclick=function(){var t=e+"/stop/"+u;o(t,function(t){w(u,!0)})}})}