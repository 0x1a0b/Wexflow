function WexflowManager(t,e){"use strict";function n(t,e){t.disabled=e}function s(t,e){for(;t.charAt(t.length-1)===e;)t=t.substring(0,t.length-1);return t}function a(t,e){return t.Id<e.Id?-1:t.Id>e.Id?1:0}function i(t){switch(t){case 0:return"Startup";case 1:return"Trigger";case 2:return"Periodic";case 3:return"Cron";default:return""}}function o(){r(e+"/search?s="+encodeURIComponent(g.value),function(t){function s(t,n){r(e+"/workflow/"+t,function(t){n(t)})}function o(t,e){s(t,function(t){if(t.IsEnabled===!1)d("This workflow is disabled."),n(h,!0),n(b,!0),n(I,!0),n(p,!0);else{if(e===!1&&m(t)===!1)return;n(h,t.IsRunning),n(p,!(t.IsRunning&&!t.IsPaused)),n(b,!(t.IsRunning&&!t.IsPaused)),n(I,!t.IsPaused),d(t.IsRunning===!0&&t.IsPaused===!1?"This workflow is running...":t.IsPaused===!0?"This workflow is suspended.":"")}})}function m(t){var e=l[t.Id].IsRunning!==t.IsRunning||l[t.Id].IsPaused!==t.IsPaused;return l[t.Id].IsRunning=t.IsRunning,l[t.Id].IsPaused=t.IsPaused,e}t.sort(a);var y,g=[];for(y=0;y<t.length;y++){var v=t[y];l[v.Id]=v;var k=i(v.LaunchType);g.push("<tr><td class='wf-id' title='"+v.Id+"'>"+v.Id+"</td><td class='wf-n' title='"+v.Name+"'>"+v.Name+"</td><td class='wf-lt'>"+k+"</td><td class='wf-e'><input type='checkbox' readonly disabled "+(v.IsEnabled?"checked":"")+"></input></td><td class='wf-d' title='"+v.Description+"'>"+v.Description+"</td></tr>")}var E="<table id='wf-workflows-table' class='table table-hover'><thead class='thead-inverse'><tr><th class='wf-id'>Id</th><th class='wf-n'>Name</th><th class='wf-lt'>LaunchType</th><th class='wf-e'>Enabled</th><th class='wf-d'>Description</th></tr></thead><tbody>"+g.join("")+"</tbody></table>";document.getElementById("wf-workflows").innerHTML=E;var B=document.getElementById("wf-workflows-table"),T=document.getElementsByClassName("wf-d");for(y=0;y<T.length;y++)T[y].style.width=B.offsetWidth-517+"px";var x=B.getElementsByTagName("tbody")[0].getElementsByTagName("tr");for(y=0;y<x.length;y++)x[y].onclick=function(){u=parseInt(this.getElementsByClassName("wf-id")[0].innerHTML);var t=document.getElementsByClassName("selected");t.length>0&&(t[0].className=t[0].className.replace("selected","")),this.className+="selected",clearInterval(f),l[u].IsEnabled===!0?(f=setInterval(function(){o(u,!1)},w),o(u,!0)):o(u,!0)};h.onclick=function(){var t=e+"/start/"+u;c(t)},b.onclick=function(){var t=e+"/suspend/"+u;c(t,function(){o(u,!0)})},I.onclick=function(){var t=e+"/resume/"+u;c(t)},p.onclick=function(){var t=e+"/stop/"+u;c(t,function(){o(u,!0)})}},function(){alert("An error occured while retrieving workflows. Check Wexflow Web Service Uri and check that Wexflow Windows Service is running correctly.")})}function d(t){document.getElementById("wf-notifier-text").value=t}function r(t,e,n){var s=new XMLHttpRequest;s.onreadystatechange=function(){if(4===this.readyState&&200===this.status&&e){var t=JSON.parse(this.responseText);e(t)}},s.onerror=function(){n&&n()},s.open("GET",t,!0),s.send()}function c(t,e){var n=new XMLHttpRequest;n.onreadystatechange=function(){4===this.readyState&&200===this.status&&e&&e()},n.open("POST",t,!0),n.send()}e=s(e,"/");var u=-1,l={},f=null,w=500,m="<div id='wf-container'><div id='wf-cmd'><button id='wf-start' type='button' class='btn btn-primary btn-sm'>Start</button><button id='wf-pause' type='button' class='btn btn-secondary btn-sm'>Suspend</button><button id='wf-resume' type='button' class='btn btn-secondary btn-sm'>Resume</button><button id='wf-stop' type='button' class='btn btn-danger btn-sm'>Stop</button></div><div id='wf-notifier'><input id='wf-notifier-text' type='text' name='fname' readonly></div><div id='wf-search'><div id='wf-search-text-container'><input id='wf-search-text' type='text' name='fname'></div><button id='wf-search-action' type='button' class='btn btn-primary btn-sm'>Search</button></div><div id='wf-workflows'></div></div>";document.getElementById(t).innerHTML=m;var h=document.getElementById("wf-start"),b=document.getElementById("wf-pause"),I=document.getElementById("wf-resume"),p=document.getElementById("wf-stop"),y=document.getElementById("wf-search-action"),g=document.getElementById("wf-search-text");n(h,!0),n(b,!0),n(I,!0),n(p,!0),y.onclick=function(){o(),d(""),n(h,!0),n(b,!0),n(I,!0),n(p,!0)},g.onkeyup=function(t){event.preventDefault(),13===event.keyCode&&(o(),d(""),n(h,!0),n(b,!0),n(I,!0),n(p,!0))},o()}